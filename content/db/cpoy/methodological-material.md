---
title: –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª
draft: false
---

[source](https://dbcourse.yonote.ru/share/a5c04212-5b70-4881-ad01-51ce69969820/doc/metodicheskij-material-64kPu1Lat7)

–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª

üß†

**PostgreSQL**¬†‚Äî —ç—Ç–æ¬†*—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö*¬†(–†–°–£–ë–î). –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ –≤–∏–¥–µ¬†***–æ—Ç–Ω–æ—à–µ–Ω–∏–π*¬†(relation)**. **–û—Ç–Ω–æ—à–µ–Ω–∏–µ** ‚Äî —ç—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–æ—á–Ω–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ¬†**_—Ç–∞–±–ª–∏—Ü—ã_**. –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Ç–∞–∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è, —á—Ç–æ —ç—Ç–æ –∫–∞–∂–µ—Ç—Å—è —Å–∞–º—ã–º –æ—á–µ–≤–∏–¥–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º, —Ö–æ—Ç—è –µ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö —Å–ø–æ—Å–æ–±–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ–∞–π–ª—ã –∏ –∫–∞—Ç–∞–ª–æ–≥–∏ –≤ Unix-–ø–æ–¥–æ–±–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –æ–±—Ä–∞–∑—É—é—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –∞ —Å–µ–≥–æ–¥–Ω—è –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—é—Ç—Å—è –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

–õ—é–±–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä¬†**_—Å—Ç—Ä–æ–∫ (–∫–∞—Ä—Ç–µ–∂–µ–π)_**. –í—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –Ω–∞–±–æ—Ä –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö¬†**_—Å—Ç–æ–ª–±—Ü–æ–≤ (–∞—Ç—Ç—Ä–∏–±—É—Ç–æ–≤)_**, –ø—Ä–∏ —ç—Ç–æ–º –∫–∞–∂–¥–æ–º—É —Å—Ç–æ–ª–±—Ü—É –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö. –•–æ—Ç—è –ø–æ—Ä—è–¥–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫–∞—Ö —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω, –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ SQL –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∫–∞–∫–æ–π-–ª–∏–±–æ –ø–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ (—Ö–æ—Ç—è –∏—Ö –º–æ–∂–Ω–æ —è–≤–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –≤—ã–≤–æ–¥–µ).

**–¢–∞–±–ª–∏—Ü—ã** –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ **–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**, –∞ –Ω–∞–±–æ—Ä **–±–∞–∑ –¥–∞–Ω–Ω—ã—Ö**, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π –æ–¥–Ω–∏–º —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–∞¬†PostgreSQL, –æ–±—Ä–∞–∑—É–µ—Ç¬†***==–∫–ª–∞—Å—Ç–µ—Ä==*¬†==–±–∞–∑ –¥–∞–Ω–Ω—ã—Ö==**.

–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Postgres c –æ–±—â–∏–º –ª–∏—Å—Ç–∏–Ω–≥–æ–º SELECT: [https://www.postgresql.org/docs/current/sql-select.html](https://www.postgresql.org/docs/current/sql-select.html)

# –õ–ê–ë–ê 1

==WHERE== ==ORDER BY== ==DISTINCT== ==LIKE== ==aggregate func==

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã, –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å¬†**_–∑–∞–ø—Ä–æ—Å_**. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω¬†SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä¬†`SELECT`. –û–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å—Ç–µ–π: –≤—ã–±–æ—Ä–∫–∏ (–≤ –∫–æ—Ç–æ—Ä–æ–π –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è —Å—Ç–æ–ª–±—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω—ã), —Å–ø–∏—Å–∫–∞ —Ç–∞–±–ª–∏—Ü (–≤ –Ω—ë–º –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è —Ç–∞–±–ª–∏—Ü—ã, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –ø–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ) –∏ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏—è (–æ–ø—Ä–µ–¥–µ–ª—è—é—â–µ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è). –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã¬†product, –≤–≤–µ–¥–∏—Ç–µ:

```
SELECT * FROM production.product;
```

–ó–¥–µ—Å—å¬†\*¬†‚Äî —ç—Ç–æ –∫—Ä–∞—Ç–∫–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ¬†¬´–≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤¬ª.¬†–¢–∞–∫–∂–µ –º—ã –º–æ–∂–µ–º —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å:

```
SELECT productid, name FROM production.product;
```

–í —Å–ø–∏—Å–∫–µ –≤—ã–±–æ—Ä–∫–∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø–∏—Å–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–æ–ª–±—Ü—ã, –Ω–æ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å:

```
SELECT productid, name, listprice - standardcost AS discountsize
FROM production.product;
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ¬†AS¬†–ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤—ã—Ö–æ–¥–Ω–æ–π —Å—Ç–æ–ª–±–µ—Ü. (–°–∞–º–æ —Å–ª–æ–≤–æ¬†AS¬†–º–æ–∂–Ω–æ –æ–ø—É—Å–∫–∞—Ç—å.)

–ó–∞–ø—Ä–æ—Å –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å¬†¬´—É—Å–ª–æ–≤–∏–µ–º¬ª, –¥–æ–±–∞–≤–∏–≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ¬†WHERE, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö —Å—Ç—Ä–æ–∫. –í –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏¬†WHERE¬†—É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–∏–Ω–Ω–æ—Å—Ç–∏), –∫–æ—Ç–æ—Ä–æ–µ —Å–ª—É–∂–∏—Ç —Ñ–∏–ª—å—Ç—Ä–æ–º —Å—Ç—Ä–æ–∫: –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ —Å—Ç—Ä–æ–∫–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–∏–Ω–Ω–æ. –í —ç—Ç–æ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ –º–æ–≥—É—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã (AND,¬†OR¬†–∏¬†NOT).

```
SELECT name, listprice, color
FROM production.product
WHERE listprice = 3578.27 AND (size = '62' OR color = 'Red');
```

–û–ø–µ—Ä–∞—Ç–æ—Ä IN –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–º—É –∏ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å–ø–∏—Å–∫–µ

```
SELECT name, color FROM production.product

WHERE color IN ('Red','Black','Silver');
```

–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–∞ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:

```
SELECT firstname, middlename, lastname
FROM person.person
ORDER BY firstname ASC, middlename DESC, lastname ASC;
```

–¢–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–≤–æ–¥–∏–º—ã—Ö —Å—Ç—Ä–æ–∫:

```
SELECT name, listprice
FROM production.product
ORDER BY listprice DESC
LIMIT 5;
```

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –≤—ã –º–æ–∂–µ—Ç–µ —É–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞:

```
SELECT DISTINCT color, size
FROM production.product;
```

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Å—Ç—Ä–æ–∫–µ, –∞ —à–∞–±–ª–æ–Ω—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è –Ω–∞ –±—É–∫–≤—É ‚ÄòD‚Äô. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä LIKE:

```
SELECT name FROM production.product
WHERE name LIKE 'D%';
```

–¢–µ–º–∞ —Ä–µ–≥—É–ª—è—Ä–æ–∫ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–±—à–∏—Ä–Ω–∞, –ø–æ—ç—Ç–æ–º—É —Å–æ–≤–µ—Ç—É—é –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–µ–π –≤ –æ—Ñ. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: [https://www.postgresql.org/docs/current/functions-matching.html](https://www.postgresql.org/docs/current/functions-matching.html)

–í —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –æ—Å–æ–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äì NULL. –û–Ω —Å–æ–æ–±—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, —á—Ç–æ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç—Ç–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å—Ä–∞–≤–Ω–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ IS.

```
SELECT name FROM production.product
WHERE color IS NULL;
```

–î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —Ü–≤–µ—Ç –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω.

```
SELECT name FROM production.product
WHERE color IS NOT NULL;
```

–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω —Ä–∞–∑–º–µ—Ä, —Ç.–µ. –æ–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è NULL.

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π. –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—á–∏—Å–ª—è—é—Ç –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞–¥ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –Ω–∞–±–æ—Ä–æ–º —Å—Ç—Ä–æ–∫. –î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É –Ω–∞—Å –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–æ–¥—É–∫—Ç:

```
SELECT count(*) FROM production.product;
```

–ò–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∞ –∫—Ä–∞—Å–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞:

```
SELECT max(listprice) FROM production.product
WHERE color = 'Red';
```

–°–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π:

[https://www.postgresql.org/docs/current/functions-aggregate.html](https://www.postgresql.org/docs/current/functions-aggregate.html)

–¢–∞–∫ –∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —É—Å–ª–æ–≤–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö:

```
SELECT name
FROM production.product
WHERE len(name) = 5
```

–°–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏:

[https://www.postgresql.org/docs/current/functions-string.html](https://www.postgresql.org/docs/current/functions-string.html)

# –õ–ê–ë–ê 2

==GROUP BY== ==aggregate func==

–Ø–∑—ã–∫ —Ç–∞–∫ –∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –í—ã—Ä–∞–∂–µ–Ω–∏–µ GROUP BY –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∞—Ç—Ä–∏–±—É—Ç—É –∏ –≤—ã—á–∏—Å–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã —Å –ø–æ–º–æ—â—å—é –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

–ü—Ä–∏–º–µ—Ä—ã –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:

COUNT¬†‚Äî —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ.

SUM¬†‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—É–º–º—ã –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤.

MAX –∏ MIN¬†‚Äî –Ω–∞—Ö–æ–¥—è—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤.

AVG¬†‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤.

–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π:

[https://www.postgresql.org/docs/current/functions-aggregate.html](https://www.postgresql.org/docs/current/functions-aggregate.html)

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ:

```
SELECT COUNT(DISTINCT —Åolor) FROM production.product
WHERE color IS NOT NULL
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω SELECT, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–±–µ—Ä–µ—Ç –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —Ü–≤–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è COUNT, –∫–æ—Ç–æ—Ä–∞—è –ø–æ—Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è DISTINCT –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä –Ω–µ–ø–æ–≤—Ç–æ—Ä—è—é—â–µ–π—Å—è –∑–Ω–∞—á–µ–Ω–∏–π —Ü–≤–µ—Ç–∞, –∞ —Ñ—É–Ω–∫—Ü–∏—è COUNT —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

–ó–∞–ø—Ä–æ—Å —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω —Ü–≤–µ—Ç –ø—Ä–æ–¥—É–∫—Ç–∞:

```
SELECT COUNT(color) FROM production.product
WHERE color IS NOT NULL
```

–í—ã—Ä–∞–∂–µ–Ω–∏–µ GROUP BY –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –≥—Ä—É–ø–ø—ã –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç—É –∏–ª–∏ –∏–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞–¥ –∫–∞–∂–¥–æ–π –∏–∑ –≥—Ä—É–ø–ø.

```
SELECT color, COUNT(*) AS amount
FROM production.product
WHERE color IS NOT NULL
GROUP BY color
```

–í –¥–∞–Ω–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ ¬´—Ü–≤–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω¬ª, —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ —Ü–≤–µ—Ç—É, –∏ –Ω–∞–¥ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è COUNT. –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Å—Ç–∞–Ω–µ—Ç –¥–≤–∞ –∞—Ç—Ä–∏–±—É—Ç–∞ –≤ –≤—ã–±–æ—Ä–∫–µ ‚Äì —Ü–≤–µ—Ç –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ —Å –¥–∞–Ω–Ω—ã–º —Ü–≤–µ—Ç–æ–º –≤ –æ–±—â–µ–π –≤—ã–±–æ—Ä–∫–µ.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π. –ü—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ –∑–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ–π –≥—Ä—É–ø–ø—ã. –ó–∞–ø—Ä–æ—Å –≤–∏–¥–∞

```
SELECT name, color, COUNT(*) AS amount
FROM production.product
WHERE color IS NOT NULL
GROUP BY color
```

–Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –≤ –≥—Ä—É–ø–ø–µ –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏. –î–∞–∂–µ –µ—Å–ª–∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ —Å –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ —Ü–≤–µ—Ç–æ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –∏–º–µ—é—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –≤—Å–µ —Ä–∞–≤–Ω–æ —ç—Ç–æ –±—É–¥–µ—Ç –æ—à–∏–±–∫–æ–π.

–ï—Å–ª–∏ —Å—Ç–æ–ª–±–µ—Ü, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞, —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è NULL, —Ç–æ –æ–Ω–∏ –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –∫–∞–∫ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –∏ –±—É–¥—É—Ç –æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –≥—Ä—É–ø–ø—É.

–î–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∞ —Ç–∞–∫–∂–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–≤—É–º –∏ –±–æ–ª–µ–µ –∞—Ç—Ä–∏–±—É—Ç–∞–º:

```
SELECT color, style, COUNT(*) AS amount
FROM production.product
WHERE color IS NOT NULL AND style IS NOT NULL
GROUP BY color, style
```

–í—ã—Ä–∞–∂–µ–Ω–∏–µ GROUP BY –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º HAVING,

–∫–æ—Ç–æ—Ä–æ–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—Å–ª–æ–≤–∏–µ —É–∂–µ –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏. (WHERE —Å–Ω–∞—á–∞–ª–∞ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∞ –ø–æ—Ç–æ–º –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å—Å—è)

```
SELECT color, COUNT(*) AS amount
FROM production.product
WHERE color IS NOT NULL
GROUP BY color
HAVING COUNT(*)>10
```

–î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤—ã–¥–∞—Å—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –¥–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞, –Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Ö –≥—Ä—É–ø–ø, –≥–¥–µ —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–æ–ª—å—à–µ 10. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ, —á—Ç–æ —Ü–≤–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω.

–°—É—â–µ—Å—Ç–≤—É—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é GROUP BY ROLLUP, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≤–æ–¥–∏—Ç—å –∏ –æ–±—â–∏–µ –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∏—Ç–æ–≥–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏. –ß–∞—Å—Ç–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –±—É–¥–µ—Ç —Ç–∞–∫–æ–π:

```
SELECT —Å—Ç–æ–ª–±–µ—Ü1, —Å—Ç–æ–ª–±–µ—Ü2, —Å—Ç–æ–ª–±–µ—Ü3, COUNT(*)
FROM —Ç–∞–±–ª–∏—Ü–∞
GROUP BY ROLLUP (—Å—Ç–æ–ª–±–µ—Ü1, —Å—Ç–æ–ª–±–µ—Ü2, —Å—Ç–æ–ª–±–µ—Ü3)
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –±—É–¥—É—Ç –≤—ã–≤–µ–¥–µ–Ω—ã –∏—Ç–æ–≥–∏ –æ–±—â–µ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ —Ç—Ä–µ–º –∞—Ç—Ä–∏–±—É—Ç–∞–º, –∞ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏. –í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–µ—Ä–≤—ã–º –¥–≤—É–º –∞—Ç—Ä–∏–±—É—Ç–∞–º, —Ç—Ä–µ—Ç–∏–π —Å—Ç–æ–ª–±–µ—Ü –±—É–¥–µ—Ç –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ NULL, —ç—Ç–æ —Å—Ç—Ä–æ–∫–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–µ—Ä–≤–æ–º—É –∞—Ç—Ä–∏–±—É—Ç—É, –≤—Ç–æ—Ä–æ–π –∏ —Ç—Ä–µ—Ç–∏–π –±—É–¥—É—Ç –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ NULL, –∏ –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –≥–¥–µ –ø–µ—Ä–≤—ã–π, –≤—Ç–æ—Ä–æ–π –∏ —Ç—Ä–µ—Ç–∏–π –∞—Ç—Ä–∏–±—É—Ç—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ NULL.

–î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –µ–µ —Ä–∞–±–æ—Ç—ã –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏.

```
SELECT color, style, class, COUNT(*)
FROM production.product
GROUP BY color, style, class
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ —Ç—Ä–µ–º –∞—Ç—Ä–∏–±—É—Ç–∞–º, —á–µ—Ç–≤–µ—Ä—Ç—ã–π —Å—Ç–æ–ª–±–µ—Ü —ç—Ç–æ —á–∏—Å–ª–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –≤ –≥—Ä—É–ø–ø–µ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∫–ª–∞—Å—Å–æ–º, —Å—Ç–∏–ª–µ–º –∏ —Ü–≤–µ—Ç–æ–º.

–û–ø–µ—Ä–∞—Ü–∏—è GROUP BY CUBE( ), —Ç–æ–ª—å–∫–æ –∫ –±–∞–∑–æ–≤–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ GROUP BY –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏.

**CUBE**¬†–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–æ—á–µ—Ç–∞–Ω–∏–π –∫–æ–ª–æ–Ω–æ–∫, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏. –¢–æ –µ—Å—Ç—å –¥–ª—è —Å–ª—É—á–∞—è¬†**CUBE(_c1, c2, c3_)** (–≥–¥–µ —Å1, c2, c3 ‚Äî –∏–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫) –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è:  
_(—Å1, null, null)_  
_(null, c2, null)_  
_(null, null, c3)_  
_(c1, c2, null)_  
_(c1, null, c3)_  
_(null, c2, c3)_  
_(c1, c2, c3)_  
_(null, null, null)_

```
SELECT color, style, class, COUNT(*)
FROM production.product
GROUP BY CUBE (color, style, class)
```

GROUP BY ROLLUP –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ö–æ–∂–∏–º –æ–±—Ä–∞–∑–æ–º, —Å —Ç–µ–º –æ—Ç–ª–∏—á–∏–µ–º, —á—Ç–æ¬†**ROLLUP**¬†–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ—á–µ—Ç–∞–Ω–∏—è, —É–±–∏—Ä–∞—è –∫–æ–ª–æ–Ω–∫–∏ –ø–æ –æ–¥–Ω–æ–π —Å –∫–æ–Ω—Ü–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º,¬†**ROLLUP(_c1, c2, c3, c4_)**¬†–≤–µ—Ä–Ω–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è:

_(c1, c2, c3, c4)_  
_(c1, c2, c3, null)_  
_(c1, c2, null, null)_  
_(c1, null, null, null)_  
_(null, null, null, null)_

```
SELECT color, style, class, COUNT(*)
FROM production.product
GROUP BY ROLLUP (color, style, class)
```

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Ç–µ –∂–µ —Å—Ç—Ä–æ–∫–∏, –∫–∞–∫ –∏ –ø—Ä–∏ –æ–±—ã—á–Ω–æ–º GROUP BY, –∞ —Ç–∞–∫–∂–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ —Ü–≤–µ—Ç—É –∏ —Å—Ç–∏–ª—é, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π —Ç–æ–ª—å–∫–æ –ø–æ —Ü–≤–µ—Ç—É –∏ —Å—Ç—Ä–æ–∫—É –±–µ–∑ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏.

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è GROUP BY GROUPING SETS ( ) –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π GROUP BY.

```
SELECT COUNT(*)
FROM production.product
GROUP BY GROUPING SETS ((color),(size))
```

# –õ–ê–ë–ê 3

==JOIN==

–î–æ —ç—Ç–æ–≥–æ –≤—Å–µ –Ω–∞—à–∏ –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞—â–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –∫ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ. –û–¥–Ω–∞–∫–æ –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç —Ç–∞–∫–∂–µ –æ–±—Ä–∞—â–∞—Ç—å—Å—è —Å—Ä–∞–∑—É –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ç–∞–±–ª–∏—Ü–∞–º –∏–ª–∏ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ç–æ–π –∂–µ —Ç–∞–±–ª–∏—Ü–µ —Ç–∞–∫, —á—Ç–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è —Ä–∞–∑–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –µ—ë —Å—Ç—Ä–æ–∫. –ó–∞–ø—Ä–æ—Å—ã, –æ–±—Ä–∞—â–∞—é—â–∏–µ—Å—è –∫ —Ä–∞–∑–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —ç–∫–∑–µ–º–ø–ª—è—Ä–∞–º –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã), –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è¬†*—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏*¬†(JOIN). –¢–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ, –∫–∞–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –Ω—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü—ã.

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å –¥—Ä—É–≥–æ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç foreign key(FK, –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á), –∫–æ—Ç–æ—Ä—ã–π —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ primary key(PK, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á) –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü—ã.

![](https://dbcourse.yonote.ru/api/attachments.redirect?id=94d361d7-dfb8-40ad-9c63-b7e3f7a92a08&shareId=a5c04212-5b70-4881-ad01-51ce69969820&documentId=a016e804-78f0-41ee-ae3f-6d89b56d5bfb)

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –≤–∏–¥–∏–º, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ product –∏–º–µ–µ—Ç –∞—Ç—Ä–∏–±—É—Ç category_id –∫–æ—Ç–æ—Ä—ã–π —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ PK —Ç–∞–±–ª–∏—Ü—ã category.

–í–ø–æ–ª–Ω–µ –¥–æ–ø—É—Å—Ç–∏–º —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å:

```
SELECT product.name, category.name FROM product, category
```

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º—ã –ø–æ–ª—É—á–∏–º –¥–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü (**CROSS JOIN**).

![](https://dbcourse.yonote.ru/api/attachments.redirect?id=218fc056-7fdd-43a5-80ea-698ec8c56d7f&shareId=a5c04212-5b70-4881-ad01-51ce69969820&documentId=a016e804-78f0-41ee-ae3f-6d89b56d5bfb)

–ù–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞—Å –≤—Ä—è–¥ –ª–∏ —É—Å—Ç—Ä–æ–∏—Ç.

–¢–æ–≥–¥–∞ –¥–∞–≤–∞–π—Ç–µ —è–≤–Ω–æ —É–∫–∞–∂–µ–º –ø—Ä–∞–≤–∏–ª–æ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —Å—Ç–æ–∏—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—Ç—å —Ç–∞–±–ª–∏—Ü—ã:

```
SELECT * FROM product JOIN category ON product.category_id = category.category_id
```

![](https://dbcourse.yonote.ru/api/attachments.redirect?id=d6e9def1-a5d4-46fc-b4be-dfb9e0c8e68f&shareId=a5c04212-5b70-4881-ad01-51ce69969820&documentId=a016e804-78f0-41ee-ae3f-6d89b56d5bfb)

–£–∂–µ –ª—É—á—à–µ, –Ω–æ –≤ —Ç–∞–∫–æ–º –∑–∞–ø—Ä–æ—Å–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –Ω–µ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã, –∞ —Ç–æ–ª—å–∫–æ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é. –î–∞–Ω–Ω—ã–π —Ç–∏–ø —Å–≤—è–∑–∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **INNER JOIN**.

–ß—Ç–æ–±—ã –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã, –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ª–∏—á–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –Ω–∞–º –Ω—É–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è LEFT JOIN:

```
SELECT * FROM product LEFT JOIN category ON product.category_id = category.category_id
```

![](https://dbcourse.yonote.ru/api/attachments.redirect?id=47887f94-7b40-4146-aeb4-ad3216a8d4f1&shareId=a5c04212-5b70-4881-ad01-51ce69969820&documentId=a016e804-78f0-41ee-ae3f-6d89b56d5bfb)

–í—Å–µ –≤–∏–¥—ã –¥–∂–æ–∏–Ω–æ–≤ –∏ –∏—Ö —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –±–æ–ª–µ–µ –Ω–∞–≥–ª—è–¥–Ω–æ:

![](https://dbcourse.yonote.ru/api/attachments.redirect?id=0e1faa2c-fcb0-43ae-bfeb-52427514c681&shareId=a5c04212-5b70-4881-ad01-51ce69969820&documentId=a016e804-78f0-41ee-ae3f-6d89b56d5bfb)

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—â–µ –≤—Å–µ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è INNER –ò LEFT.

–ü–æ–ø—Ä–æ–±—É–µ–º —Å–¥–µ–ª–∞—Ç—å —Ç–æ–∂–µ —Å–∞–º–æ–µ –Ω–∞ —É—á–µ–±–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```
SELECT p.name, s.name
FROM production.product AS p INNER JOIN
production.productSubcategory AS s
ON p.ProductSubcategoryID = s.ProductSubcategoryID
```

(–ö—Å—Ç–∞—Ç–∏ –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞–ª–∏–∞—Å–∞–º–∏ AS.)

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –∏ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∫ –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Ç–æ–≤–∞—Ä, –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã —Ç–æ–≤–∞—Ä—ã, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞. INNER JOIN –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç NULL –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∫ –≤ –ª–µ–≤–æ–π, —Ç–∞–∫ –∏ –≤ –ø—Ä–∞–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏. –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ –¥–æ–ø—É—Å—Ç–∏–º–æ –∏ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è INNER JOIN –¥–æ –ø—Ä–æ—Å—Ç–æ JOIN. –í —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–º –≤—ã—à–µ –∑–∞–ø—Ä–æ—Å–µ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è —Ç–∞–±–ª–∏—Ü—ã Product –∏

ProductSubcategory, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–µ–µ—Ç —Å—Ç–æ–ª–±–µ—Ü —Å –∏–º–µ–Ω–µ–º Name. –ß—Ç–æ–±—ã —Ä–∞–∑–ª–∏—á–∞—Ç—å —ç—Ç–∏ —Å—Ç–æ–ª–±—Ü—ã –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏, –±—ã–ª–∏ –≤–≤–µ–¥–µ–Ω—ã –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã —Ç–∞–±–ª–∏—Ü, –∏ –∫ —Å—Ç–æ–ª–±—Ü—É Name –æ–±—Ä–∞—â–µ–Ω–∏–µ –∏–¥–µ—Ç —á–µ—Ä–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä –¥–æ—Å—Ç—É–ø ‚Äì —Ç–æ—á–∫–∞.

```
SELECT p.Name, s.Name
FROM production.product AS p LEFT JOIN
production.productSubcategory AS s
ON p.ProductSubcategoryID = s.ProductSubcategoryID
```

LEFT JOIN —É—á–∏—Ç—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è NULL –∏–∑ –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–∏–∂–µ–ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∏ —Ç–µ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ —É –ø—Ä–æ–¥—É–∫—Ç–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è. –ï—Å–ª–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, —Ç–æ –µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±—É–¥–µ—Ç NULL.
